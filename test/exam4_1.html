<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <center>
        <div
            style="width: 500px; margin: 5px; padding: 5px; border: 5px outset red; background-color: lightgoldenrodyellow;">
            <h3>학생정보입력</h3>
            <hr>
            학번 <input type="text" id="studentNo">
            <br>
            이름 <input type="text" id="name">
            <br>
            전공 <input type="text" id="major">
            <br>
            학년 &nbsp;&nbsp; <select name="grade" id="grade">
                <option value="1">1학년</option>
                <option value="2">2학년</option>
                <option value="3">3학년</option>
                <option value="4">4학년</option>
            </select>
            <br>
            <hr>
            <button id="btn">등록</button>
            <hr>
            학년별 학생 정보 <select name="grades" id="grades" onchange="onchangeFunc()">
                <option value="1">1학년</option>
                <option value="2">2학년</option>
                <option value="3">3학년</option>
                <option value="4">4학년</option>
            </select>
            <hr>
            <p id="show"></p>
        </div>



        <script>
            var students = []
            var temp = []
            var btn = document.getElementById("btn");
            btn.onclick = addFunc


            function addFunc() {
                if (temp.length == 0) {
                    var show_li = document.querySelectorAll('#show > li')
                    show_li.forEach(function (o) {
                        o.remove();
                    });
                }

                var student = {
                    studentNo: document.getElementById("studentNo").value,
                    name: document.getElementById("name").value,
                    grade: document.getElementById("grade").value,
                    major: document.getElementById("major").value
                }
                students.push(student);
                temp.unshift(student);
                var $show = document.getElementById("show");

                var $text = document.createTextNode("학번: " + temp[0].studentNo + ", 이름: " + temp[0].name + ", 학년: " + temp[0].grade + ", 전공: " + temp[0].major);
                var $li = document.createElement("li");
                $li.appendChild($text);
                $show.appendChild($li);
            }

            function onchangeFunc() {
                var filterAry = students.filter(function (o, i) {
                    return o.grade == document.getElementById("grades").value;
                });

                temp = []
                var $show = document.getElementById("show");
                var show_li = document.querySelectorAll('#show > li')
                show_li.forEach(function (o) {
                    o.remove();
                });
                // var cnt = $show.children.length;
                // for (var i = 0; i < cnt; i++) {
                //     $show.removeChild($show.firstChild);
                // }
                filterAry.forEach(function (o) {
                    var $text = document.createTextNode("학번: " + o.studentNo + ", 이름: " + o.name + ", 학년: " + o.grade + ", 전공: " + o.major);
                    var $li = document.createElement("li");
                    $li.appendChild($text);
                    $show.appendChild($li);
                });

            }
        </script>
    </center>
</body>

</html>